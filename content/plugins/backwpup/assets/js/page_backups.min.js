(function(e,s,c){var w,l,n,i,o,d,t,a,r;if(!s){console.warn('Missing ajaxurl value.');return};if(!('EventSource' in window)){console.warn('Event Source does not exist in this browser');return};window.addEventListener('load',function(){n=e('#download-file-waiting');i=e('#download-file-generating');o=e('#download-file-private-key');d=e('#download-file-done');t=e('#download-file-private-key-input');a=e('#download-file-private-key-invalid');r=e('#download-file-private-key-button');e('.backup-download-link').click(function(){n.show();i.hide();o.hide();d.hide();w=this;l=new EventSource(s+'?action=download_file&destination='+e(this).data('destination')+'&jobid='+e(this).data('jobid')+'&file='+e(this).data('file')+'&local_file='+e(this).data('localFile')+'&_wpnonce='+e(this).data('nonce'));l.onmessage=function(r){var s=JSON.parse(r.data);if('downloading'===s.state){n.hide();i.show();o.hide();d.hide();e('#progresssteps').css({width:s.download_percent+'%'}).text(s.download_percent+'%')};if('need-private-key'===s.state){n.hide();i.hide();o.show();d.hide();t.focus();if('invalid'===s.status){a.show();return};a.hide()};if('done'===s.state){n.hide();i.hide();o.hide();d.show();l.close();window.location.href=e(w).data('url');setTimeout(c,3000)}}});r.click(function(){var n={action:'send_private_key',privatekey:t.val(),};e.post(s,n,function(e){if(!0===e.success){t.val('');a.hide();o.hide();i.show()}})})})}(window.jQuery,window.ajaxurl,window.tb_remove));